def jenkinsImage

pipeline {
    agent any
    environment {
        DOCKERHUB_REPO = "mcieciora/responsible_dugong"
    }
    stages {
        stage ("Checkout branch") {
            steps {
                script {
                    jenkinsImage = docker.build("${DOCKERHUB_REPO}:jenkins_image")
                }
            }
        }
        stage ("Run Jenkins instance tests") {
            steps {
                script {
                    sh "chmod +x scripts/test_jenkins_setup.sh"
                    sh "scripts/test_jenkins_setup.sh"
                }
            }
        }
    }
    post {
        always {
            cleanWs()
        }
    }
}